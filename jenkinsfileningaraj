node{
buildName 'Dev - ${BUILD_NUMBER}'
buildDescription 'Pipeline Script - Scriptedway'
    
    def mavenHome= tool name: "maven3.9.4"


    echo "The Node name is:  ${env.NODE_NAME} "
    echo "The Build number is:  ${env.BUILD_NUMBER} "
    echo "The Job name is:  ${env.JOB_NAME} "
    echo "This is jenkins url: ${env.BRANCH_NAME} "

    properties([buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '5', daysToKeepStr: '', numToKeepStr: '5')), [$class: 'JobLocalConfiguration', changeReasonComment: '']])
    
    //code checkout
    stage('CheckoutCode'){
        git branch: 'development', credentialsId: 'd831d652-2f27-43e5-83e6-5e20db10013c', url: 'https://github.com/NingarajYalameli/maven-web-application.git'
    }  
    
    //build stage
    stage('Build'){
        sh "$mavenHome/bin/mvn clean package"
    }
    /*
    //generate sonarqube report
    stage('SonarQubeReport'){
       sh "$mavenHome/bin/mvn sonar:sonar"
    }
    
     //upload artifacts into artifactory repo
    stage('UploadArtifactsIntoNexus'){
       sh "$mavenHome/bin/mvn deploy"
    }
    
    //Deploy app to Tomcat server
    stage('DeployAppToTomcatServer'){
        sshagent(['8391a145-5341-4718-8756-cb997265d9a4']) {
    sh "scp -o StrictHostKeyChecking=no target/maven-web-application.war ec2-user@13.234.119.56:/opt/apache-tomcat-9.0.79/webapps"
    }
    }
*/
}
